<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>관리자 업로드 – 천둥 코칭</title>
<meta name="description" content="천둥 코칭 테마 그대로 적용된 관리자 전용 동영상 업로드 페이지. 드래그&드롭, 미리보기, 진행률 표시 지원." />
<link rel="canonical" href="https://thunder-svg.github.io/admin-upload.html" />
<meta name="robots" content="noindex, nofollow" />

<style>
:root{
  --bg:#0b1220; --panel:#0f182b; --card:#111b30; --stroke:#213354;
  --text:#e8eef6; --muted:#a8b4c6; --accent:#ffd84d; --shadow:0 10px 30px rgba(0,0,0,.45);
  --radius:16px; --maxw:1120px;
}
*{box-sizing:border-box}
html,body{margin:0;background:var(--bg);color:var(--text);
  font-family:system-ui,-apple-system,Segoe UI,Roboto,Pretendard,'Noto Sans KR',sans-serif;line-height:1.5}
a{color:inherit;text-decoration:none}
a:focus,button:focus{outline:2px solid var(--accent);outline-offset:3px;border-radius:8px}
.container{max-width:var(--maxw);margin:0 auto;padding:0 18px}

/* Top nav (사이트 공통) */
nav.top{position:sticky;top:0;backdrop-filter:saturate(140%) blur(8px);
  background:rgba(11,18,32,.7);border-bottom:1px solid #1b2a48;z-index:10}
.top .inner{max-width:var(--maxw);margin:0 auto;padding:10px 18px;
  display:flex;gap:10px;align-items:center;justify-content:space-between}
.logo a{font-weight:900;letter-spacing:.02em}
.nav a{margin-left:14px;color:#cfe0ff}
.nav a:hover{color:#fff}

/* Hero */
header.site{position:relative;overflow:hidden;background:
  radial-gradient(120% 100% at 50% 0%, #101a30 0%, #0b1220 60%),
  linear-gradient(180deg, rgba(24,39,73,.9), rgba(11,18,32,.9)), #0b1220}
.hero{padding:56px 0 30px;text-align:center}
.hero h1{margin:8px 0 6px;font-size:32px;font-weight:900;letter-spacing:.02em}
.hero p{margin:0 auto;max-width:760px;color:var(--muted)}
.badge{display:inline-block;margin-left:8px;padding:4px 10px;border-radius:999px;background:#1b2744;border:1px solid #2d3e66;color:#cfe0ff;font-size:12px}

/* Sections & cards */
.section{padding:34px 0}
.card{background:var(--card);border:1px solid var(--stroke);border-radius:16px;padding:16px;box-shadow:var(--shadow)}
.row{display:flex;gap:14px;flex-wrap:wrap;align-items:center}
.btn{display:inline-block;padding:10px 16px;border-radius:999px;background:#1b2744;border:1px solid #2d3e66;color:#cfe0ff;cursor:pointer}
.btn:hover{background:#223258}
.btn[disabled]{opacity:.6;cursor:not-allowed}

/* Dropzone */
.drop{border:2px dashed #35507e;background:#0e1a2f;border-radius:14px;padding:18px;text-align:center}
.drop.highlight{border-color:#6ea8ff;background:#11233e}
.drop .icon{width:40px;height:40px;margin:0 auto 8px;border-radius:999px;background:#1b2744;border:1px solid #2d3e66;display:grid;place-items:center}
.drop p{margin:6px 0;color:#cfe0ff}
.help{font-size:12px;color:#9db2c7}

/* Grid */
.grid{display:grid;gap:16px}
.grid-2{grid-template-columns:repeat(2,minmax(0,1fr))}
@media (max-width:900px){.grid-2{grid-template-columns:1fr}}

/* File list */
.item{display:grid;grid-template-columns:120px 1fr;gap:12px;align-items:start}
.thumb{width:100%;height:78px;background:#0f1a30;border:1px solid #20324e;border-radius:12px;display:grid;place-items:center;overflow:hidden}
.thumb video{width:100%;height:100%;object-fit:cover}
.meta{font-size:12px;color:#a8b4c6;margin-bottom:6px}
.name{font-weight:700}
.badge-soft{display:inline-block;padding:2px 8px;border-radius:999px;background:#1b2744;border:1px solid #2d3e66;color:#cfe0ff;font-size:11px;margin-left:6px}
.progress{width:100%;height:8px;border-radius:8px;background:#0f1a30;border:1px solid #20324e;overflow:hidden}
.progress>span{display:block;height:100%;background:linear-gradient(90deg,#4da3ff,#ffd84d);width:0%}
.status{font-size:12px;color:#cfe0ff;margin-top:6px}

/* Footer */
footer{padding:40px 0 60px;color:#9db2c7;text-align:center}
</style>
</head>
<body>
  <!-- 상단 네비 -->
  <nav class="top" aria-label="주요 메뉴">
    <div class="inner">
      <div class="logo"><a href="index.html" aria-label="홈으로">천둥 코칭</a></div>
      <div class="nav" role="navigation">
        <a href="index.html#service">서비스</a>
        <a href="index.html#features">강의특징</a>
        <a href="reviews.html">후기</a>
        <a href="price.html">가격표</a>
        <a href="blog.html">블로그</a>
        <a class="btn" style="padding:8px 14px" href="https://open.kakao.com/o/slMcbCLh" target="_blank" rel="noopener">상담하기</a>
      </div>
    </div>
  </nav>

  <!-- 히어로 -->
  <header class="site">
    <div class="container hero">
      <div class="brand" style="font-size:13px;color:#c9d5ea">관리자 전용</div>
      <h1>동영상 업로드 <span class="badge">드래그&드롭 · 미리보기 · 진행률</span></h1>
      <p>이 페이지는 로그인 없이 열람할 수 있으니 <b>공개 링크 공유 금지</b>를 권장합니다. 실제 저장은 <b>업로드 엔드포인트</b>가 필요합니다(입력 시 FormData POST).</p>
    </div>
  </header>

  <main>
    <section class="section container">
      <div class="grid grid-2">
        <!-- 업로드 컨트롤 -->
        <article class="card">
          <h2 style="margin:0 0 10px">파일 선택</h2>
          <div id="dropzone" class="drop" role="button" tabindex="0" aria-label="여기에 동영상을 드래그 앤 드롭하거나 클릭해서 선택">
            <div class="icon" aria-hidden="true">
              <!-- 업로드 아이콘 -->
              <svg viewBox="0 0 24 24" width="22" height="22" fill="none" stroke="#cfe0ff">
                <path d="M12 3v12M7 8l5-5 5 5" />
                <rect x="3" y="14" width="18" height="7" rx="2" />
              </svg>
            </div>
            <p><b>여기에 파일을 놓기</b> 또는 <b>클릭하여 선택</b></p>
            <p class="help">지원: mp4, webm, mov 등 <code>video/*</code> · 파일당 최대 <span id="maxSizeLabel">512MB</span> (수정 가능)</p>
            <input id="fileInput" type="file" accept="video/*" multiple hidden />
          </div>

          <div class="row" style="margin-top:12px">
            <button class="btn" id="pickBtn">파일 선택</button>
            <button class="btn" id="uploadBtn" disabled>업로드 시작</button>
            <button class="btn" id="clearBtn">목록 비우기</button>
          </div>

          <div class="card" style="margin-top:12px;background:#0e1a2f">
            <div class="meta"><b>업로드 설정</b></div>
            <div class="row" style="gap:10px">
              <label class="help">엔드포인트(URL):</label>
              <input id="endpoint" type="url" placeholder="예: https://api.example.com/upload" style="flex:1;min-width:240px;padding:10px;border-radius:12px;border:1px solid #20324e;background:#0f1a30;color:#e8eef6" />
            </div>
            <div class="row" style="margin-top:8px;gap:10px">
              <label class="help">파일당 최대(MB):</label>
              <input id="maxSize" type="number" min="1" value="512" style="width:100px;padding:10px;border-radius:12px;border:1px solid #20324e;background:#0f1a30;color:#e8eef6" />
              <label class="help">총 개수 제한:</label>
              <input id="maxCount" type="number" min="1" value="10" style="width:100px;padding:10px;border-radius:12px;border:1px solid #20324e;background:#0f1a30;color:#e8eef6" />
            </div>
            <p class="help" style="margin-top:8px">엔드포인트를 비워두면 <b>미리보기 전용</b>으로 동작합니다. 실제 업로드에는 서버 CORS 허용과 <b>multipart/form-data</b> 처리(필드명 <code>file</code>)가 필요합니다.</p>
          </div>
        </article>

        <!-- 파일 목록/상태 -->
        <article class="card">
          <h2 style="margin:0 0 10px">대기열 · 진행상태</h2>
          <div id="list" class="grid" style="--gap:12px"></div>
          <p id="empty" class="help" style="margin-top:6px">선택된 파일이 없습니다.</p>
        </article>
      </div>
    </section>

    <section class="section container">
      <div class="card">
        <h3 style="margin:0 0 8px">안내</h3>
        <ul class="help" style="margin:0 0 6px 18px">
          <li>“업로드 시작”은 입력한 엔드포인트로 <b>multipart/form-data</b> POST 전송합니다(필드명: <code>file</code>).</li>
          <li>진행률은 브라우저 <b>XMLHttpRequest</b> 업로드 이벤트 기반으로 표시합니다.</li>
          <li>대용량은 서버에서 <b>청크/리줌</b>을 구현하면 안정적입니다.</li>
          <li>보안을 위해 이 페이지의 URL은 외부에 공개하지 마세요.</li>
        </ul>
        <div class="row" style="margin-top:10px">
          <a class="btn" href="index.html">메인으로</a>
          <a class="btn" href="viewport.html">시청 전용(미리보기)</a>
        </div>
      </div>
    </section>
  </main>

  <footer>© 2025 천둥 코칭</footer>

<script>
/** ====== 간단 상태 ====== */
const state = {
  files: [], // { id, file, url, size, name, type, duration, progress, status, _bar, _status }
};
const els = {
  drop: document.getElementById('dropzone'),
  input: document.getElementById('fileInput'),
  pickBtn: document.getElementById('pickBtn'),
  uploadBtn: document.getElementById('uploadBtn'),
  clearBtn: document.getElementById('clearBtn'),
  list: document.getElementById('list'),
  empty: document.getElementById('empty'),
  endpoint: document.getElementById('endpoint'),
  maxSize: document.getElementById('maxSize'),
  maxCount: document.getElementById('maxCount'),
  maxSizeLabel: document.getElementById('maxSizeLabel')
};

function fmtBytes(bytes){
  if(bytes === 0) return '0 B';
  const k = 1024, sizes = ['B','KB','MB','GB','TB'];
  const i = Math.floor(Math.log(bytes)/Math.log(k));
  return parseFloat((bytes/Math.pow(k,i)).toFixed(2))+' '+sizes[i];
}

function setEmptyVisible(){
  els.empty.style.display = state.files.length ? 'none' : 'block';
  els.uploadBtn.disabled = !state.files.length;
}

function render(){
  els.list.innerHTML = '';
  state.files.forEach(item => {
    const root = document.createElement('div');
    root.className = 'item';

    // thumbnail
    const thumb = document.createElement('div');
    thumb.className = 'thumb';
    const vid = document.createElement('video');
    vid.muted = true; vid.playsInline = true; vid.preload = 'metadata';
    if(item.url) vid.src = item.url;
    thumb.appendChild(vid);

    // load duration
    vid.addEventListener('loadedmetadata', ()=>{
      item.duration = vid.duration;
      meta.innerHTML = `
        <span class="name">${item.name}</span>
        <span class="badge-soft">${item.type || 'video'}</span>
        <span class="badge-soft">${fmtBytes(item.size)}</span>
        <span class="badge-soft">${isFinite(item.duration)? Math.round(item.duration) + 's' : '—'}</span>
      `;
    });

    // right side
    const right = document.createElement('div');
    const meta = document.createElement('div');
    meta.className = 'meta';
    meta.innerHTML = `
      <span class="name">${item.name}</span>
      <span class="badge-soft">${item.type || 'video'}</span>
      <span class="badge-soft">${fmtBytes(item.size)}</span>
      <span class="badge-soft">…</span>
    `;

    const controls = document.createElement('div');
    controls.className = 'row';
    const previewBtn = document.createElement('button');
    previewBtn.className = 'btn'; previewBtn.textContent = '미리보기';
    previewBtn.addEventListener('click', ()=>{
      const w = window.open('', '_blank');
      w.document.write(`<title>${item.name}</title><video controls autoplay style="width:100%;height:100%"></video>`);
      const v = w.document.querySelector('video');
      v.src = item.url; v.addEventListener('loadedmetadata', ()=> v.play().catch(()=>{}));
    });

    const removeBtn = document.createElement('button');
    removeBtn.className = 'btn'; removeBtn.textContent = '삭제';
    removeBtn.addEventListener('click', ()=>{
      if(item.url) URL.revokeObjectURL(item.url);
      state.files = state.files.filter(f => f.id !== item.id);
      render(); setEmptyVisible();
    });

    controls.appendChild(previewBtn);
    controls.appendChild(removeBtn);

    const bar = document.createElement('div');
    bar.className = 'progress'; const span = document.createElement('span'); bar.appendChild(span);

    const status = document.createElement('div');
    status.className = 'status';
    status.textContent = item.status || '대기 중';

    // bind for progress updates
    item._bar = span; item._status = status;

    right.appendChild(meta);
    right.appendChild(controls);
    right.appendChild(bar);
    right.appendChild(status);

    root.appendChild(thumb);
    root.appendChild(right);
    els.list.appendChild(root);
  });
}

/** ====== 파일 추가/검증 ====== */
function addFiles(fileList){
  const maxMB = parseInt(els.maxSize.value || '512', 10);
  const maxCount = parseInt(els.maxCount.value || '10', 10);
  els.maxSizeLabel.textContent = maxMB + 'MB';

  for(const f of fileList){
    if(!f.type.startsWith('video/')){
      alert(`동영상만 업로드 가능합니다: ${f.name}`); continue;
    }
    if(f.size > maxMB*1024*1024){
      alert(`파일 용량 초과(${maxMB}MB): ${f.name}`); continue;
    }
    if(state.files.length >= maxCount){
      alert(`파일 개수 제한(${maxCount}개)에 도달했습니다.`); break;
    }
    const id = crypto.randomUUID ? crypto.randomUUID() : String(Date.now())+Math.random();
    state.files.push({
      id, file:f, url:URL.createObjectURL(f),
      size:f.size, name:f.name, type:f.type, progress:0, status:'대기 중'
    });
  }
  render(); setEmptyVisible();
}

/** ====== 드롭존 이벤트 ====== */
['dragenter','dragover'].forEach(evt=>{
  els.drop.addEventListener(evt, e=>{ e.preventDefault(); e.stopPropagation(); els.drop.classList.add('highlight'); });
});
['dragleave','drop'].forEach(evt=>{
  els.drop.addEventListener(evt, e=>{ e.preventDefault(); e.stopPropagation(); els.drop.classList.remove('highlight'); });
});
els.drop.addEventListener('drop', e=>{
  addFiles(e.dataTransfer.files);
});
els.drop.addEventListener('click', ()=> els.input.click());
els.drop.addEventListener('keydown', (e)=>{ if(e.key==='Enter' || e.key===' '){ e.preventDefault(); els.input.click(); }});
els.input.addEventListener('change', ()=> addFiles(els.input.files));

els.pickBtn.addEventListener('click', ()=> els.input.click());
els.clearBtn.addEventListener('click', ()=>{
  state.files.forEach(f=> f.url && URL.revokeObjectURL(f.url));
  state.files = []; render(); setEmptyVisible();
});

/** ====== 업로드 (엔드포인트 있으면 전송, 없으면 데모 진행률) ====== */
async function uploadOne(item, endpoint){
  item.status = endpoint ? '업로드 시작' : '미리보기 전용(서버 미설정)'; 
  item._status && (item._status.textContent = item.status);

  if(!endpoint){
    await simulateProgress(item);
    item.status = '완료(미리보기만)'; 
    item._status && (item._status.textContent = item.status);
    return;
  }

  await new Promise((resolve, reject)=>{
    const form = new FormData(); form.append('file', item.file, item.name);
    const xhr = new XMLHttpRequest();
    xhr.open('POST', endpoint, true);
    xhr.upload.onprogress = (e)=>{
      if(e.lengthComputable){
        const pct = Math.round((e.loaded/e.total)*100);
        item.progress = pct; item._bar && (item._bar.style.width = pct+'%');
        item._status && (item._status.textContent = `업로드 중… ${pct}%`);
      }
    };
    xhr.onload = ()=>{
      if(xhr.status >= 200 && xhr.status < 300){
        item.progress = 100; item._bar && (item._bar.style.width = '100%');
        item.status = '업로드 완료'; item._status && (item._status.textContent = item.status);
        resolve();
      }else{
        item.status = `실패(${xhr.status})`; item._status && (item._status.textContent = item.status);
        reject(new Error(xhr.statusText || 'Upload failed'));
      }
    };
    xhr.onerror = ()=>{ item.status = '에러'; item._status && (item._status.textContent = item.status); reject(new Error('Network error')); };
    xhr.send(form);
  });
}

function simulateProgress(item){
  return new Promise((res)=>{
    let pct = 0;
    const timer = setInterval(()=>{
      pct += Math.random()*18+5;
      if(pct>=100){ pct=100; clearInterval(timer); }
      item.progress = pct; item._bar && (item._bar.style.width = pct+'%');
      item._status && (item._status.textContent = `처리 중… ${Math.round(pct)}%`);
      if(pct===100){ setTimeout(res, 300); }
    }, 200);
  });
}

document.getElementById('uploadBtn').addEventListener('click', async ()=>{
  const endpoint = (els.endpoint.value||'').trim();
  if(!endpoint){
    if(!confirm('엔드포인트가 비어 있습니다. 서버 업로드 없이 미리보기 전용으로 진행할까요?')) return;
  }
  els.uploadBtn.disabled = true;
  for(const item of state.files){
    try{ await uploadOne(item, endpoint); }
    catch(e){ console.error(e); }
  }
  els.uploadBtn.disabled = false;
});

// 초기
setEmptyVisible();
</script>
</body>
</html>
