<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>동영상 라이브러리 – 천둥 코칭</title>
<meta name="description" content="깃허브 Pages에서 manifest.json을 읽어와 영상 목록을 보여주고 재생합니다. 서버 없이 시청 전용." />
<link rel="canonical" href="https://thunder-svg.github.io/viewport.html" />
<meta name="robots" content="index,follow" />
<style>
:root{
  --bg:#0b1220; --panel:#0f182b; --card:#111b30; --stroke:#213354;
  --text:#e8eef6; --muted:#a8b4c6; --accent:#ffd84d; --shadow:0 10px 30px rgba(0,0,0,.45);
  --radius:16px; --maxw:1120px;
}
*{box-sizing:border-box}
html,body{margin:0;background:var(--bg);color:var(--text);
  font-family:system-ui,-apple-system,Segoe UI,Roboto,Pretendard,'Noto Sans KR',sans-serif;line-height:1.5}
a{color:inherit;text-decoration:none}
a:focus,button:focus{outline:2px solid var(--accent);outline-offset:3px;border-radius:8px}
.container{max-width:var(--maxw);margin:0 auto;padding:0 18px}

/* Top nav (사이트 공통) */
nav.top{position:sticky;top:0;backdrop-filter:saturate(140%) blur(8px);
  background:rgba(11,18,32,.7);border-bottom:1px solid #1b2a48;z-index:10}
.top .inner{max-width:var(--maxw);margin:0 auto;padding:10px 18px;
  display:flex;gap:10px;align-items:center;justify-content:space-between}
.logo a{font-weight:900;letter-spacing:.02em}
.nav a{margin-left:14px;color:#cfe0ff}
.nav a:hover{color:#fff}

/* Hero */
header.site{position:relative;overflow:hidden;background:
  radial-gradient(120% 100% at 50% 0%, #101a30 0%, #0b1220 60%),
  linear-gradient(180deg, rgba(24,39,73,.9), rgba(11,18,32,.9)), #0b1220}
.hero{padding:56px 0 30px;text-align:center}
.hero h1{margin:8px 0 6px;font-size:32px;font-weight:900;letter-spacing:.02em}
.hero p{margin:0 auto;max-width:760px;color:var(--muted)}
.badge{display:inline-block;margin-left:8px;padding:4px 10px;border-radius:999px;background:#1b2744;border:1px solid #2d3e66;color:#cfe0ff;font-size:12px}

/* Layout */
.section{padding:34px 0}
.grid{display:grid;gap:16px}
.grid-main{grid-template-columns:2fr 1fr}
@media (max-width:900px){.grid-main{grid-template-columns:1fr}}

.card{background:var(--card);border:1px solid var(--stroke);border-radius:16px;padding:16px;box-shadow:var(--shadow)}
h2{margin:0 0 10px}

/* Player */
.player video{width:100%;height:auto;border-radius:12px;border:1px solid #20324e;background:#000}
.title{font-weight:800;margin-top:10px}
.meta{font-size:12px;color:var(--muted)}

/* List */
.search{display:flex;gap:10px;margin-bottom:12px}
.search input{flex:1;padding:10px 12px;border-radius:12px;border:1px solid #20324e;background:#0f1a30;color:#e8eef6}
.list{display:grid;grid-template-columns:repeat(1, minmax(0,1fr));gap:10px;max-height:70vh;overflow:auto}
.item{display:grid;grid-template-columns:120px 1fr;gap:10px;align-items:center;
  border:1px solid #20324e;background:#0e1a2f;border-radius:12px;padding:8px;cursor:pointer}
.item:hover{background:#11233e}
.thumb{width:100%;height:70px;border-radius:8px;overflow:hidden;background:#0f1a30;display:grid;place-items:center}
.thumb img{width:100%;height:100%;object-fit:cover}
.name{font-weight:700}
.badge-soft{display:inline-block;padding:2px 8px;border-radius:999px;background:#1b2744;border:1px solid #2d3e66;color:#cfe0ff;font-size:11px;margin-left:6px}
.empty{color:#9db2c7;font-size:13px;margin-top:6px}

/* Buttons */
.btn{display:inline-block;padding:10px 16px;border-radius:999px;background:#1b2744;border:1px solid #2d3e66;color:#cfe0ff;cursor:pointer}
.btn:hover{background:#223258}

footer{padding:40px 0 60px;color:#9db2c7;text-align:center}
</style>
</head>
  <!-- Channel.io 기본 위젯 (카카오 링크 건드리지 않음) -->
<script>
(function(){
  var w=window;if(w.ChannelIO){return;}
  var ch=function(){ch.c(arguments);};ch.q=[];ch.c=function(args){ch.q.push(args);};w.ChannelIO=ch;
  function l(){ if(w.ChannelIOInitialized){return;} w.ChannelIOInitialized=true;
    var s=document.createElement('script'); s.type='text/javascript'; s.async=true;
    s.src='https://cdn.channel.io/plugin/ch-plugin-web.js';
    var x=document.getElementsByTagName('script')[0]; x.parentNode.insertBefore(s,x);
  }
  if(document.readyState==='complete'){ l(); }
  else if(window.attachEvent){ window.attachEvent('onload', l); }
  else { window.addEventListener('DOMContentLoaded', l, false); window.addEventListener('load', l, false); }
})();
ChannelIO('boot', {
  pluginKey: '9ee9db76-f06f-483f-a1e5-7f92977cdeda',
  trackDefaultEvent: true,
  profile: { page: location.href, userAgent: navigator.userAgent } // 선택: 페이지/브라우저 정보 기록
});
</script>

<body>
  <!-- 상단 네비 -->
  <nav class="top" aria-label="주요 메뉴">
    <div class="inner">
      <div class="logo"><a href="index.html" aria-label="홈으로">천둥 코칭</a></div>
      <div class="nav" role="navigation">
        <a href="index.html#service">서비스</a>
        <a href="index.html#features">강의특징</a>
        <a href="reviews.html">후기</a>
        <a href="price.html">가격표</a>
        <a href="blog.html">블로그</a>
        <a class="btn" style="padding:8px 14px" href="https://open.kakao.com/o/slMcbCLh" target="_blank" rel="noopener">상담하기</a>
      </div>
    </div>
  </nav>

  <!-- 히어로 -->
  <header class="site">
    <div class="container hero">
      <div class="brand" style="font-size:13px;color:#c9d5ea">시청 전용</div>
    </div>
  </header>

  <main>
    <section class="section container">
      <div class="grid grid-main">
        <!-- 좌: 플레이어 -->
        <article class="card player">
          <video id="player" controls preload="metadata" poster="" playsinline></video>
          <div class="title" id="playerTitle">영상 제목</div>
          <div class="meta" id="playerMeta"></div>
          <div style="margin-top:10px;display:flex;gap:8px;flex-wrap:wrap">
            <button class="btn" id="openRaw">원본 열기</button>
            <a class="btn" href="viewport.html">새로고침</a>
          </div>
        </article>

        <!-- 우: 목록 -->
        <aside class="card">
          <h2>목록</h2>
          <div class="search">
            <input id="q" type="search" placeholder="제목/태그 검색…" />
          </div>
          <div id="list" class="list"></div>
          <div id="empty" class="empty" style="display:none">표시할 영상이 없습니다.</div>
        </aside>
      </div>
    </section>
  </main>

  <footer>© 2025 천둥 코칭</footer>

<script>
const PLAYER = document.getElementById('player');
const TITLE = document.getElementById('playerTitle');
const META  = document.getElementById('playerMeta');
const LIST  = document.getElementById('list');
const EMPTY = document.getElementById('empty');
const OPEN  = document.getElementById('openRaw');
const Q     = document.getElementById('q');

let allVideos = [];
let current = null;

// manifest.json 형식(예시)
// {
//   "videos":[
//     {"title":"정글 동선 기초","file":"videos/abc.mp4","poster":"videos/abc.jpg","duration":120,"tags":["정글","기본"],"date":"2025-08-14"},
//     {"title":"라인전 포지셔닝","file":"videos/line.mp4"}
//   ]
// }

init();

async function init(){
  try{
    const res = await fetch('videos/manifest.json', {cache:'no-store'});
    if(!res.ok) throw new Error('manifest 로드 실패');
    const data = await res.json();
    allVideos = (data.videos||[]).filter(v => !!v.file);
    render(allVideos);
    if(allVideos.length){ play(allVideos[0]); }
  }catch(e){
    console.error(e);
    LIST.innerHTML = '';
    EMPTY.style.display = 'block';
    EMPTY.textContent = 'manifest.json을 불러오지 못했습니다. (videos/manifest.json 확인)';
  }
}

function render(items){
  LIST.innerHTML = '';
  if(!items.length){ EMPTY.style.display = 'block'; return; }
  EMPTY.style.display = 'none';

  items.forEach((v, i)=>{
    const el = document.createElement('div');
    el.className = 'item';
    el.innerHTML = `
      <div class="thumb">
        ${v.poster ? `<img src="${escapeAttr(v.poster)}" alt="">`
                   : `<svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="#cfe0ff">
                        <rect x="3" y="4" width="18" height="16" rx="3"></rect>
                        <path d="M10 9l6 3-6 3V9z"></path>
                      </svg>`}
      </div>
      <div>
        <div class="name">${escapeHtml(v.title||basename(v.file))}</div>
        <div class="meta">
          ${v.date ? `${v.date}` : ''} 
          ${v.duration ? `<span class="badge-soft">${Math.round(v.duration)}s</span>`:''}
          ${Array.isArray(v.tags) ? v.tags.map(t=>`<span class="badge-soft">${escapeHtml(t)}</span>`).join('') : ''}
        </div>
      </div>
    `;
    el.addEventListener('click', ()=> play(v));
    LIST.appendChild(el);
  });
}

function play(v){
  current = v;
  PLAYER.src = v.file;
  PLAYER.poster = v.poster || '';
  TITLE.textContent = v.title || basename(v.file);
  META.innerHTML = `
    경로: <code>${escapeHtml(v.file)}</code>
    ${v.duration ? ` · 길이 ${Math.round(v.duration)}초` : ''} 
    ${v.date ? ` · ${v.date}` : ''} 
    ${Array.isArray(v.tags) ? ' · ' + v.tags.map(t=>`#${escapeHtml(t)}`).join(' ') : ''}
  `;
  OPEN.onclick = ()=> window.open(v.file, '_blank');
  PLAYER.play().catch(()=>{ /* 사용자 상호작용 필요 브라우저에서는 무시 */ });
}

Q.addEventListener('input', ()=>{
  const keyword = Q.value.trim().toLowerCase();
  if(!keyword){ render(allVideos); return; }
  const filtered = allVideos.filter(v=>{
    const hay = [
      v.title||'',
      v.file||'',
      ...(v.tags||[]),
      v.date||''
    ].join(' ').toLowerCase();
    return hay.includes(keyword);
  });
  render(filtered);
});

function basename(path){ return (path||'').split('/').pop(); }
function escapeHtml(s){ return (s||'').replace(/[&<>"']/g, m=>({ '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;' }[m])); }
function escapeAttr(s){ return escapeHtml(s).replace(/"/g,'&quot;'); }
</script>
</body>
</html>
